<!DOCTYPE html>
 <html lang="cs">
 <link rel="icon" href="https://img41.rajce.idnes.cz/d4102/19/19244/19244630_db82ad174937335b1a151341387b7af2/images/image_82x82.jpg?ver=1" type="image/png">

 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Star Trek: Hudební Přehravač</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="miniPlayer.css">  
   
</head>
<body>
   
 <div class="player-content-wrapper">
        
    
     
  <div class="background-image-container">
   <img src="">
  </div>
  
  
    
     <audio id="audioPlayer">
    <source id="audioSource" src="" type="audio/mpeg">
</audio>


  <div class="player-container">
       
      <h1 class="header-title"  >STAR TREK: HUDEBNÍ PŘEHRAVAČ</h1>
    <h2 id="trackTitle">Vyberte skladbu</h2>
      
      
      <div class="time-controls" >
        <span id="currentTime" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
         <span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span>
        </span>
        <input type="range" id="progress-bar" min="0" max="100" value="0" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
        <span id="duration" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
          <span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span><span class="time-separator" style="color: white;">:</span><span class="time-part" style="color: white;">00</span>
        </span>
      </div>
      
     <!-- obal/pouzdro-->
      <div id="control-panel" >
           <!-- hl kontejner tlačítek -->
        <div class="controls">
          <button id="prev-button" title="Předchozí (Šipka vlevo)" >◀️⬅️</button>
          <button id="play-button" title="Přehrát (Mezerník/P)" >🚀</button>
          <button id="pause-button" title="Pauza (Mezerník/P)" >🖖⏸️</button>
          <button id="next-button" title="Další (Šipka vpravo)" >▶️➡️</button>
          <button id="loop-button" title="Opakovat (L)" >🔁</button>
          <button id="shuffle-button" title="Náhodně (Vypnuto)" >🔀</button>
          <button id="reset-button" title="Restartovat skladbu (R)" >🔄</button>
          <button id="fullscreen-toggle" title="Celá obrazovka (F)" >⛶</button>
          <button id="toggle-info-button" title="Zobrazit/Skrýt klávesové zkratky" >📋</button>
          <button id="reload-button" title="Obnovit stránku" >🔄</button>
          <button id="toggle-playlist-button" title="Zobrazit/Skrýt playlist" >📜</button> 
          <button id="timer-button" title="Časovač vypnutí (T)" >⏰</button>
          <button id="clearAllDataBtn" onclick="window.clearAllAudioPlayerData()" >🗑️</button>
          <button id="perf-monitor-btn">🔍📊</button>
           <button id="jirik-manual-opener-btn" >🧾</button>  
          <button id="mini-mode-float">🖼️ Float</button>
<button id="mini-mode-pip">📺 PiP</button>
<button id="mini-mode-popup">🪟 Popup</button>
 <button id="playlist-sync-button" title="Synchronizovat playlist do cloudu (Ctrl+Shift+S)">
    🔄 Sync Playlist
</button>
            <button type="button"
        onclick="window.open('archivni_zaznam_mise_star_trek_hudebni_prehravac_lcars_readme.html','_blank','noopener');"
        style="padding:10px 14px;border-radius:12px;background:#0f1830;color:#cfe6ff;border:1px solid #2a3350;">
  📜 Otevřít archivní záznam mise
</button>

        </div>
       
          
        <div class="volume-controls">
          <button id="mute-button" title="Ztlumit (M)">🔊</button>
          <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.1" title="Hlasitost (A/D)">
          <span id="volume-value">10</span>
        </div>
      </div>
      <div class="performance-mode" id="perfMode">⚡ VARIANTA B</div>
      <div id="search-container" class="search-container">
    <div class="search-input-wrapper" >
        <input  
            type="text" 
            id="search-input" 
            class="search-input" 
            placeholder="🔍 Hledat skladbu... (Ctrl+F)"
            autocomplete="off"
        />
        <button id="clear-search" class="clear-search-button" style="display: none;">✖</button>
    </div>
    <div id="search-counter" class="search-counter" style="display: none;"></div>
    <div id="search-results" class="search-results" style="display: none;"></div>
</div>

      <div class="playlist" id="playlist" style="display: block; "> 
          
           
   

  
      </div>
    </div> 
    <div class="hlavni-kontejner-pro-cas-a-casovac" >
  <div class="time-calendar-wrapper" >
    <div class="time">
      <div class="time-colon"><div class="time-text"><span class="num hours">00</span><span class="text">H</span></div></div>
      <span class="colon">:</span>
      <div class="time-colon"><div class="time-text"><span class="num minutes">00</span><span class="text">M</span></div></div>
      <span class="colon">:</span>
      <div class="time-colon"><div class="time-text"><span class="num seconds">00</span><span class="text">S</span></div></div>
    </div>
    <div class="calendar"><div class="date" id="currentDate"></div></div>
  </div>

  <div class="timer-container" id="timer-container">
    <div class="timer-display">
      <span id="timer-minutes">15</span>:<span id="timer-seconds">00</span>
    </div>
    <div class="timer-controls">
      <button id="timer-5">5 min</button>
      <button id="timer-15">15 min</button>
      <button id="timer-30">30 min</button>
      <button id="timer-60">60 min</button>
      <button id="timer-start">Start</button>
      <button id="timer-stop">Stop</button>
    </div>
  </div>
</div>
   
       <div class="keyboard-container">
        <div id="popisky"> 
         <div class="tone-meter-container" style="display:inline-block;padding:2px;background:#000;border:2px solid #C00000;color:#fff;margin:0;">
        
        <div class="tone-meter-title">
            🎵 TONE.METER ENHANCED 🎵
        </div>
        
        <div class="tone-meter-status inactive" id="statusIndicator">
            ⏹️ PŘIPRAVEN K TESTOVÁNÍ
        </div>
        
        <!-- KALIBRACE A4 -->
        <div class="tone-meter-calibration">
            <h3>🎼 KALIBRACE A4 FREKVENCE</h3>
            
            <div class="tone-meter-a4-control">
                <span style="color: #ccc;">A4 =</span>
                <input type="number" min="400" max="480" value="440" class="tone-meter-a4-input" id="a4FreqInput">
                <span style="color: #ccc;">Hz</span>
                <button class="tone-meter-a4-reset" id="resetA4Btn">Reset</button>
            </div>
            
            <div class="tone-meter-calibration-info">
                Standardní A4 = 440 Hz | Barokní A4 = 415 Hz | Moderní A4 = 442-444 Hz
            </div>
        </div>
        
        <!-- SEKCE PRO OVLÁDÁNÍ MIKROFONU -->
        <div class="tone-meter-mic-controls">
            <h3>🎚️ NASTAVENÍ MIKROFONU</h3>
            
            <div class="tone-meter-slider-group">
                <div class="tone-meter-slider-label">
                    <span>HLASITOST VSTUPU</span>
                    <span id="inputVolumeValue">100%</span>
                </div>
                <input type="range" min="0" max="10000" value="100" class="tone-meter-slider" id="inputVolumeSlider">
                <div style="font-size: 10px; color: #888; text-align: center; margin-top: 2px;">0% - 10000% (Extrémní zesílení)</div>
            </div>
            
            <div class="tone-meter-slider-group">
                <div class="tone-meter-slider-label">
                    <span>BOOST MIKROFONU</span>
                    <span id="micBoostValue">1.0x</span>
                </div>
                <input type="range" min="10" max="10000" value="100" class="tone-meter-slider" id="micBoostSlider">
                <div style="font-size: 10px; color: #888; text-align: center; margin-top: 2px;">0.1x - 1000.0x (Pro slabé signály)</div>
            </div>
            
            <div class="tone-meter-calibration-info" id="micCalibrationInfo">
                Automatická kalibrace citlivosti se spustí po startu měření
            </div>
        </div>
        
        <!-- NOVÝ: VIZUÁLNÍ TUNER -->
        <div class="tone-meter-tuner">
            
            
            <div class="tone-meter-tuner-display">
                <div class="tone-meter-current-note" id="tunerNote">---</div>
                
                <div class="tone-meter-tuner-needle-container">
                    <div class="tone-meter-tuner-scale">
                        <!-- Stupnice -50 až +50 centů -->
                        <div class="tone-meter-scale-mark" style="left: 10%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 20%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 30%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 40%;"></div>
                        <div class="tone-meter-scale-mark major center" style="left: 50%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 60%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 70%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 80%;"></div>
                        <div class="tone-meter-scale-mark" style="left: 90%;"></div>
                    </div>
                    <div class="tone-meter-tuner-needle" id="tunerNeedle"></div>
                </div>
                
                <div class="tone-meter-cent-display">
                    <span style="color: #6666ff;">♭ FLAT</span>
                    <div class="tone-meter-cent-value" id="centValue">0¢</div>
                    <span style="color: #ff6666;">SHARP ♯</span>
                </div>
                
                <div class="tone-meter-frequency-diff" id="frequencyDiff">
                    Cílová frekvence: --- Hz
                </div>
            </div>
        </div>
        
        <div class="tone-meter-controls">
            <button class="tone-meter-btn" id="startBtn">🎤 START</button>
            <button class="tone-meter-btn" id="stopBtn" disabled>⏹️ STOP</button>
            <button class="tone-meter-btn calibrate" id="calibrateBtn" disabled>🔧 KALIBRACE</button>
        </div>
        
        <div class="tone-meter-display">
            <div class="tone-meter-info">
                <div class="tone-meter-label">HLASITOST</div>
                <div class="tone-meter-value" id="volumeValue">0%</div>
            </div>
            <div class="tone-meter-info">
                <div class="tone-meter-label">FREKVENCE</div>
                <div class="tone-meter-value" id="frequencyValue">0 Hz</div>
            </div>
            <div class="tone-meter-info">
                <div class="tone-meter-label">NOTA</div>
                <div class="tone-meter-value" id="noteValue">---</div>
            </div>
        </div>
        
        <canvas class="tone-meter-visualizer" id="visualizerCanvas"></canvas>
    </div>
<div id="waveform-container">
    <canvas id="waveform-canvas"></canvas>
</div>
      
      <div id="notification"></div>
      <div class="fade-indicator">  
       </div>
    <footer>
      &copy; <span id="currentYear"  ></span> Star Trek: Hudební Přehravač | Vytvořeno s láskou ke Star Treku
    </footer>
          
  </div> </div> </div> 
    <!-- ============================================ -->
<!-- KRITICKÉ SKRIPTY - NESMÍ MÍT DEFER! -->
<!-- Musí se načíst SYNCHRONNĚ v tomto pořadí -->
<!-- ============================================ -->

<!-- Firebase SDK - musí být PŘED audioFirebaseFunctions.js -->
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

 <script src="prednacitani-pisnicek.js"></script>     
    
<!-- Hlavní přehrávač - inicializuje globální proměnné (window.tracks, window.favorites) -->
<script src="script.js"></script>

    
    
<!-- Data playlistu - naplňuje window.tracks -->
<script src="myPlaylist.js"></script>

<!-- Cloud synchronizace - poskytuje API pro ostatní moduly -->
<script src="audioFirebaseFunctions.js"></script>

<!-- ============================================ -->
<!-- FEATURE MODULY - MŮŽOU MÍT DEFER -->
<!-- Tyto skripty se načtou paralelně a spustí po DOM ready -->
<!-- ============================================ -->

<!-- Performance monitoring -->
<script src="universalni-perfomens-monitor.js" defer></script>

<!-- Debug wrapper -->
<script src="jirkuv-hlidac.js" defer></script>

<!-- Audio vizualizace / Tone Meter -->
<script src="audiou-vizuace.js" defer></script>

<!-- Notifikační systém -->
<script src="notificationFix.js" defer></script>

<!-- Automatické přechody mezi skladbami -->
<script src="autoFade.js" defer></script>

<!-- Hlasové ovládání -->
<script src="voiceControl.js" defer></script>

<!-- Nastavení vzhledu playlistu -->
<script src="playlistSettings.js" defer></script>

<!-- Pokročilá správa skladeb (CRUD operace) -->
<script src="pokrocila-sprava-playlistu.js" defer></script>

<!-- Detekce odpojení Bluetooth a kabelových sluchátek/reproduktorů -->
<script src="bluetoothDisconnectMonitor.js" defer></script>

<!-- Správa viditelnosti tlačítek -->
<script src="buttonVisibilityManager.js" defer></script>

<!-- Vyhledávač skladeb -->
<script src="vyhledavac-skladeb.js" defer></script>

<!-- UI management - finalizace rozhraní (měl by být poslední) -->
<script src="sprava-rozhrani.js" defer></script>
    
    <!-- Plovoucí okno mini Přehravače -->
    <script src="miniPlayer.js" defer></script>
 
    
    <script src="playlistSync.js" defer></script>
    
</body>
</html>




